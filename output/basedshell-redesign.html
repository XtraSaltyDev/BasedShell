<!DOCTYPE html>
<html lang="en" data-appearance="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BasedShell â€” Glassmorphic Redesign</title>
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BASEDSHELL GLASSMORPHIC REDESIGN â€” Design Tokens
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  /* Primitive palette â€” bolder, more saturated */
  --gray-950: #08090e;
  --gray-900: #0d0f16;
  --gray-850: #11141e;
  --gray-800: #161a28;
  --gray-750: #1c2234;
  --gray-700: #232b40;
  --gray-600: #2e3852;
  --gray-500: #3f4f6e;
  --gray-400: #566f94;
  --gray-300: #7590b8;
  --gray-200: #97aece;
  --gray-100: #bccbe4;
  --gray-50: #dfe8f8;

  --accent: #5bf5c4;
  --accent-bright: #8fffd9;
  --accent-dim: #3ad4a5;
  --accent-muted: rgba(91, 245, 196, 0.15);
  --accent-subtle: rgba(91, 245, 196, 0.07);
  --accent-glow: rgba(91, 245, 196, 0.25);

  --danger: #ff6b8a;
  --danger-glow: rgba(255, 107, 138, 0.2);
  --warning: #ffd06b;
  --info: #6bacff;
  --success: #5bf5c4;

  /* Glass tokens */
  --glass-bg: rgba(14, 17, 28, 0.55);
  --glass-bg-heavy: rgba(14, 17, 28, 0.72);
  --glass-bg-light: rgba(14, 17, 28, 0.35);
  --glass-border: rgba(255, 255, 255, 0.06);
  --glass-border-strong: rgba(255, 255, 255, 0.1);
  --glass-highlight: rgba(255, 255, 255, 0.04);
  --glass-blur: 24px;
  --glass-blur-heavy: 40px;

  /* Typography */
  --font-ui: 'SF Pro Display', 'Inter', system-ui, sans-serif;
  --font-mono: 'SF Mono', 'JetBrains Mono', 'Fira Code', monospace;

  /* Spacing */
  --space-1: 4px; --space-2: 8px; --space-3: 12px;
  --space-4: 16px; --space-5: 20px; --space-6: 24px;

  /* Radii â€” rounder for glassmorphic feel */
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 20px;
  --radius-full: 9999px;

  /* Motion */
  --dur-fast: 120ms;
  --dur-normal: 200ms;
  --dur-moderate: 320ms;
  --dur-slow: 500ms;
  --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
  --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
  --ease-smooth: cubic-bezier(0.25, 0.1, 0.25, 1);

  /* Layout */
  --topbar-height: 52px;
  --statusbar-height: 32px;
  --traffic-light-width: 78px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BASE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html, body {
  width: 100%; height: 100%;
  overflow: hidden;
  background: var(--gray-950);
  color: var(--gray-50);
  font-family: var(--font-ui);
  font-size: 13px;
  -webkit-font-smoothing: antialiased;
}

body {
  /* Deep gradient background with subtle color splashes */
  background:
    radial-gradient(ellipse 80% 60% at 10% 0%, rgba(91, 245, 196, 0.06) 0%, transparent 50%),
    radial-gradient(ellipse 60% 50% at 90% 10%, rgba(107, 172, 255, 0.04) 0%, transparent 40%),
    radial-gradient(ellipse 50% 40% at 50% 100%, rgba(91, 245, 196, 0.03) 0%, transparent 50%),
    var(--gray-950);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APP SHELL
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#app-shell {
  display: grid;
  grid-template-rows: var(--topbar-height) 1fr var(--statusbar-height);
  height: 100%;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOP BAR â€” Frosted glass with floating tabs
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#topbar {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: 0 var(--space-3) 0 var(--traffic-light-width);
  background: var(--glass-bg);
  backdrop-filter: blur(var(--glass-blur-heavy)) saturate(1.6);
  border-bottom: 1px solid var(--glass-border);
  position: relative;
  z-index: 10;
}

/* Subtle top-edge highlight */
#topbar::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent 5%, rgba(255,255,255,0.05) 30%, rgba(255,255,255,0.08) 50%, rgba(255,255,255,0.05) 70%, transparent 95%);
}

/* Traffic light placeholder */
.traffic-lights {
  position: absolute;
  left: 18px;
  top: 50%;
  transform: translateY(-50%);
  display: flex;
  gap: 8px;
}
.traffic-light {
  width: 12px; height: 12px;
  border-radius: 50%;
  opacity: 0.85;
}
.traffic-light.close { background: #ff5f57; }
.traffic-light.minimize { background: #febc2e; }
.traffic-light.maximize { background: #28c840; }

/* â”€â”€â”€ Tab Strip â”€â”€â”€ */
#tab-strip {
  display: flex;
  align-items: center;
  gap: 6px;
  flex: 1;
  min-width: 0;
  overflow-x: auto;
  scrollbar-width: none;
  padding: 6px 0;
}
#tab-strip::-webkit-scrollbar { display: none; }

/* â”€â”€â”€ Individual Tab â”€â”€â”€ */
.tab {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  height: 36px;
  padding: 0 14px 0 12px;
  border-radius: var(--radius-md);
  background: transparent;
  border: 1px solid transparent;
  color: var(--gray-300);
  cursor: pointer;
  white-space: nowrap;
  flex-shrink: 0;
  min-width: 120px;
  max-width: 200px;
  transition:
    background var(--dur-fast) var(--ease-smooth),
    color var(--dur-fast) var(--ease-smooth),
    border-color var(--dur-fast) var(--ease-smooth),
    box-shadow var(--dur-fast) var(--ease-smooth),
    transform 60ms var(--ease-smooth);
}

.tab:hover {
  background: var(--glass-highlight);
  color: var(--gray-100);
  border-color: var(--glass-border);
}

.tab:active {
  transform: scale(0.97);
}

.tab.active {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(var(--glass-blur)) saturate(1.4);
  border-color: var(--glass-border-strong);
  color: #fff;
  box-shadow:
    0 0 0 1px rgba(255,255,255,0.03) inset,
    0 1px 3px rgba(0,0,0,0.3),
    0 0 20px var(--accent-subtle);
}

/* Active tab accent underline */
.tab.active::after {
  content: '';
  position: absolute;
  bottom: -1px;
  left: 16px;
  right: 16px;
  height: 2px;
  border-radius: 2px;
  background: var(--accent);
  box-shadow: 0 0 12px var(--accent-glow), 0 0 4px var(--accent-glow);
}

.tab-indicator-dot {
  width: 7px; height: 7px;
  border-radius: 50%;
  flex-shrink: 0;
  transition: all var(--dur-fast) var(--ease-smooth);
}
.tab-indicator-dot.active {
  background: var(--success);
  box-shadow: 0 0 8px rgba(91, 245, 196, 0.5);
}
.tab-indicator-dot.unread {
  background: var(--info);
  box-shadow: 0 0 8px rgba(107, 172, 255, 0.5);
}
.tab-indicator-dot.exited {
  background: var(--danger);
  box-shadow: 0 0 8px var(--danger-glow);
}

.tab-title {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  font-size: 12.5px;
  font-weight: 500;
  letter-spacing: 0.01em;
}

.tab-close {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 20px; height: 20px;
  border: 0;
  border-radius: 6px;
  background: transparent;
  color: inherit;
  cursor: pointer;
  opacity: 0;
  font-size: 14px;
  line-height: 1;
  transition: all var(--dur-fast) var(--ease-smooth);
}
.tab:hover .tab-close,
.tab.active .tab-close { opacity: 0.5; }
.tab-close:hover {
  opacity: 1 !important;
  background: rgba(255, 107, 138, 0.15);
  color: var(--danger);
}

/* â”€â”€â”€ Top bar controls â”€â”€â”€ */
#topbar-controls {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-shrink: 0;
}

.icon-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 34px; height: 34px;
  border-radius: var(--radius-md);
  border: 1px solid var(--glass-border);
  background: var(--glass-bg-light);
  backdrop-filter: blur(16px);
  color: var(--gray-200);
  cursor: pointer;
  font-size: 16px;
  transition: all var(--dur-fast) var(--ease-smooth);
}
.icon-button:hover {
  background: var(--glass-bg);
  border-color: var(--glass-border-strong);
  color: #fff;
  box-shadow: 0 0 16px rgba(91, 245, 196, 0.06);
}
.icon-button:active {
  transform: scale(0.93);
  transition-duration: 50ms;
}
.icon-button.active {
  background: var(--accent-muted);
  border-color: rgba(91, 245, 196, 0.2);
  color: var(--accent);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TERMINAL HOST
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#terminal-host {
  position: relative;
  min-height: 0;
  padding: var(--space-2);
}

#terminal-host::after {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.35);
  backdrop-filter: blur(4px);
  opacity: 0;
  pointer-events: none;
  transition: opacity var(--dur-moderate) var(--ease-smooth);
  z-index: 15;
}
#terminal-host.dimmed::after { opacity: 1; }

.terminal-pane {
  position: absolute;
  inset: var(--space-2);
  border-radius: var(--radius-lg);
  overflow: hidden;
  border: 1px solid var(--glass-border);
  background: rgba(8, 9, 14, 0.7);
  backdrop-filter: blur(8px);
}

/* Fake terminal content */
.terminal-content {
  padding: var(--space-4);
  font-family: var(--font-mono);
  font-size: 13px;
  line-height: 1.6;
  color: var(--gray-100);
  height: 100%;
  overflow: auto;
}

.terminal-content .prompt {
  color: var(--accent);
  font-weight: 600;
}
.terminal-content .path {
  color: var(--info);
}
.terminal-content .command {
  color: #fff;
}
.terminal-content .output {
  color: var(--gray-300);
}
.terminal-content .muted {
  color: var(--gray-500);
}
.terminal-content .cursor-block {
  display: inline-block;
  width: 8px;
  height: 16px;
  background: var(--accent);
  border-radius: 1px;
  animation: cursor-blink 1.1s ease-in-out infinite;
  vertical-align: text-bottom;
  box-shadow: 0 0 8px var(--accent-glow);
}

@keyframes cursor-blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

/* Split pane divider */
.pane-divider {
  position: absolute;
  z-index: 5;
}
.pane-divider-vertical {
  top: var(--space-2);
  bottom: var(--space-2);
  width: 8px;
  cursor: col-resize;
}
.pane-divider-vertical::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 3px;
  height: 48px;
  border-radius: 3px;
  background: var(--glass-border);
  transition: all var(--dur-fast) var(--ease-smooth);
}
.pane-divider-vertical:hover::after {
  background: var(--accent);
  box-shadow: 0 0 10px var(--accent-glow);
  height: 72px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATUS BAR â€” Glass pills
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#statusbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: var(--space-3);
  padding: 0 var(--space-3);
  background: var(--glass-bg);
  backdrop-filter: blur(var(--glass-blur-heavy)) saturate(1.5);
  border-top: 1px solid var(--glass-border);
  position: relative;
  z-index: 10;
}

/* Top-edge subtle highlight */
#statusbar::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent 5%, rgba(255,255,255,0.04) 50%, transparent 95%);
}

.status-group {
  display: flex;
  align-items: center;
  gap: 4px;
}

.status-segment {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 3px 10px;
  border-radius: var(--radius-full);
  background: transparent;
  border: 1px solid transparent;
  color: var(--gray-400);
  font-size: 11px;
  letter-spacing: 0.02em;
  cursor: pointer;
  white-space: nowrap;
  transition: all var(--dur-fast) var(--ease-smooth);
}

.status-segment:hover {
  background: var(--glass-highlight);
  border-color: var(--glass-border);
  color: var(--gray-200);
}

.status-segment .status-dot {
  width: 6px; height: 6px;
  border-radius: 50%;
  flex-shrink: 0;
}

.status-segment.success .status-dot {
  background: var(--success);
  box-shadow: 0 0 6px rgba(91, 245, 196, 0.4);
}
.status-segment.success { color: var(--success); }

.status-segment.info .status-dot {
  background: var(--info);
  box-shadow: 0 0 6px rgba(107, 172, 255, 0.4);
}

.status-segment.warning { color: var(--warning); }

.status-segment .status-icon {
  font-size: 12px;
  line-height: 1;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SEARCH BAR â€” Inline glass
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.search-inline {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  max-width: 0;
  opacity: 0;
  overflow: hidden;
  padding: 0;
  border: 1px solid transparent;
  border-radius: var(--radius-lg);
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(var(--glass-blur));
  transition: all var(--dur-moderate) var(--ease-out);
}

.search-inline.open {
  max-width: 520px;
  opacity: 1;
  padding: 4px;
  border-color: var(--glass-border-strong);
  box-shadow: 0 0 24px rgba(91, 245, 196, 0.06), 0 4px 16px rgba(0,0,0,0.3);
}

.search-input {
  width: 200px;
  min-width: 0;
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-sm);
  background: rgba(0,0,0,0.3);
  color: #fff;
  padding: 5px 10px;
  font-size: 12px;
  font-family: var(--font-mono);
  outline: none;
  transition: border-color var(--dur-fast) var(--ease-smooth);
}
.search-input:focus {
  border-color: rgba(91, 245, 196, 0.3);
  box-shadow: 0 0 0 2px rgba(91, 245, 196, 0.1);
}
.search-input::placeholder { color: var(--gray-500); }

.search-counter {
  color: var(--gray-400);
  font-size: 11px;
  font-family: var(--font-mono);
  min-width: 60px;
  text-align: center;
}

.search-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 28px;
  min-width: 28px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--glass-border);
  background: rgba(0,0,0,0.2);
  color: var(--gray-200);
  cursor: pointer;
  font-size: 12px;
  padding: 0 8px;
  font-family: var(--font-mono);
  transition: all var(--dur-fast) var(--ease-smooth);
}
.search-btn:hover {
  background: var(--glass-bg);
  border-color: var(--glass-border-strong);
}
.search-btn.active {
  background: var(--accent-muted);
  border-color: rgba(91, 245, 196, 0.25);
  color: var(--accent);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMMAND PALETTE â€” Vivid glass modal
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.palette-scrim {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(8px);
  opacity: 0;
  pointer-events: none;
  transition: opacity var(--dur-moderate) var(--ease-out);
  z-index: 70;
}
.palette-scrim.open {
  opacity: 1;
  pointer-events: auto;
}

.command-palette {
  position: fixed;
  top: 18%;
  left: 50%;
  width: min(560px, 90vw);
  max-height: min(65vh, 500px);
  transform: translate(-50%, -16px) scale(0.96);
  opacity: 0;
  pointer-events: none;
  display: flex;
  flex-direction: column;
  border: 1px solid var(--glass-border-strong);
  border-radius: var(--radius-xl);
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(var(--glass-blur-heavy)) saturate(1.8);
  box-shadow:
    0 24px 80px rgba(0,0,0,0.6),
    0 0 0 1px rgba(255,255,255,0.04) inset,
    0 0 60px rgba(91, 245, 196, 0.04);
  overflow: hidden;
  z-index: 80;
  transition: all var(--dur-moderate) var(--ease-out);
}
.command-palette.open {
  transform: translate(-50%, 0) scale(1);
  opacity: 1;
  pointer-events: auto;
}

.palette-header {
  padding: var(--space-4) var(--space-5);
  border-bottom: 1px solid var(--glass-border);
}

.palette-input {
  width: 100%;
  border: 0;
  outline: none;
  background: transparent;
  color: #fff;
  font-size: 15px;
  font-weight: 400;
  letter-spacing: -0.01em;
}
.palette-input::placeholder { color: var(--gray-500); }

.palette-results {
  list-style: none;
  overflow-y: auto;
  padding: var(--space-2) 0;
  max-height: 360px;
}

.palette-item {
  margin: 0 var(--space-2);
}

.palette-action {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
  width: 100%;
  padding: 10px var(--space-4);
  border: 0;
  border-radius: var(--radius-md);
  background: transparent;
  color: var(--gray-100);
  cursor: pointer;
  text-align: left;
  transition: all var(--dur-fast) var(--ease-smooth);
}
.palette-action:hover,
.palette-item.active .palette-action {
  background: var(--accent-muted);
}

.palette-action-icon {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius-sm);
  background: var(--glass-bg);
  border: 1px solid var(--glass-border);
  font-size: 14px;
  flex-shrink: 0;
}

.palette-text {
  flex: 1;
  min-width: 0;
}
.palette-title {
  font-size: 13px;
  font-weight: 500;
  color: var(--gray-50);
}
.palette-meta {
  font-size: 11px;
  color: var(--gray-400);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.palette-shortcut {
  font-size: 11px;
  color: var(--gray-400);
  font-family: var(--font-mono);
  display: flex;
  gap: 4px;
}
.palette-shortcut kbd {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 22px;
  height: 20px;
  padding: 0 5px;
  border-radius: 5px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.08);
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--gray-200);
}

.palette-footer {
  padding: var(--space-2) var(--space-5);
  border-top: 1px solid var(--glass-border);
  font-size: 11px;
  color: var(--gray-500);
  display: flex;
  gap: var(--space-4);
}
.palette-footer kbd {
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 4px;
  padding: 1px 5px;
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--gray-300);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SETTINGS PANEL â€” Full glass sidebar
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.settings-scrim {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(6px);
  opacity: 0;
  pointer-events: none;
  transition: opacity var(--dur-moderate) var(--ease-out);
  z-index: 18;
}
.settings-scrim.open { opacity: 1; pointer-events: auto; }

.settings-panel {
  position: fixed;
  top: 0; right: 0;
  width: min(400px, 95vw);
  height: 100vh;
  display: grid;
  grid-template-rows: 56px 1fr 60px;
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(var(--glass-blur-heavy)) saturate(1.6);
  border-left: 1px solid var(--glass-border-strong);
  box-shadow: -12px 0 48px rgba(0,0,0,0.4);
  transform: translateX(100%);
  opacity: 0;
  pointer-events: none;
  transition: all var(--dur-moderate) var(--ease-out);
  z-index: 20;
}
.settings-panel.open {
  transform: translateX(0);
  opacity: 1;
  pointer-events: auto;
}

.settings-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--space-5);
  border-bottom: 1px solid var(--glass-border);
}
.settings-header h2 {
  font-size: 15px;
  font-weight: 600;
  letter-spacing: -0.01em;
  color: #fff;
}
.settings-close {
  width: 32px; height: 32px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--glass-border);
  background: rgba(255,255,255,0.04);
  color: var(--gray-300);
  cursor: pointer;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all var(--dur-fast) var(--ease-smooth);
}
.settings-close:hover {
  background: rgba(255, 107, 138, 0.12);
  border-color: rgba(255, 107, 138, 0.2);
  color: var(--danger);
}

.settings-body {
  overflow-y: auto;
  padding: var(--space-5);
  display: grid;
  gap: var(--space-6);
}

.settings-section h3 {
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--gray-400);
  margin-bottom: var(--space-3);
}

.settings-section {
  display: grid;
  gap: var(--space-4);
}

.setting-row {
  display: grid;
  gap: 6px;
}
.setting-row > label {
  font-size: 12px;
  color: var(--gray-300);
  font-weight: 500;
}

.setting-input {
  width: 100%;
  padding: 8px 12px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--glass-border-strong);
  background: rgba(0,0,0,0.3);
  color: #fff;
  font-size: 13px;
  font-family: var(--font-mono);
  outline: none;
  transition: all var(--dur-fast) var(--ease-smooth);
}
.setting-input:focus {
  border-color: rgba(91, 245, 196, 0.3);
  box-shadow: 0 0 0 3px rgba(91, 245, 196, 0.08);
}

.setting-select {
  width: 100%;
  padding: 8px 12px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--glass-border-strong);
  background: rgba(0,0,0,0.35);
  color: #fff;
  font-size: 13px;
  outline: none;
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%237590b8'%3E%3Cpath d='M2 4l4 4 4-4'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
  cursor: pointer;
}

/* Theme swatches */
.theme-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
}
.theme-swatch {
  position: relative;
  height: 44px;
  border-radius: var(--radius-sm);
  border: 1.5px solid var(--glass-border);
  cursor: pointer;
  display: flex;
  align-items: flex-end;
  padding: 5px 8px;
  font-size: 10px;
  font-weight: 500;
  color: var(--gray-200);
  transition: all var(--dur-fast) var(--ease-spring);
  overflow: hidden;
}
.theme-swatch::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  opacity: 0.15;
}
.theme-swatch:hover {
  transform: scale(1.04);
  border-color: var(--glass-border-strong);
}
.theme-swatch.selected {
  border-color: var(--accent);
  box-shadow: 0 0 16px var(--accent-glow), 0 0 0 1px var(--accent) inset;
}
.theme-swatch.selected::after {
  content: 'âœ“';
  position: absolute;
  top: 4px; right: 6px;
  font-size: 11px;
  color: var(--accent);
}

.swatch-graphite { background: linear-gradient(135deg, #0b0d12 0%, #1a1f2b 100%); }
.swatch-midnight { background: linear-gradient(135deg, #070b13 0%, #111826 100%); }
.swatch-aurora { background: linear-gradient(135deg, #0a0e1a 0%, #141b30 50%, #1d2445 100%); }
.swatch-noir { background: linear-gradient(135deg, #000 0%, #111 100%); }
.swatch-fog { background: linear-gradient(135deg, #1c1b1f 0%, #2a2731 100%); }
.swatch-paper { background: linear-gradient(135deg, #f0ede4 0%, #fff 100%); color: #5c5a54; }
.swatch-mocha { background: linear-gradient(135deg, #1e1e2e 0%, #313244 100%); }
.swatch-frappe { background: linear-gradient(135deg, #303446 0%, #414559 100%); }
.swatch-macchiato { background: linear-gradient(135deg, #24273a 0%, #363a4f 100%); }

/* Toggle switch (replaces checkbox) */
.toggle-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
}
.toggle-row span {
  font-size: 12px;
  color: var(--gray-300);
  font-weight: 500;
}
.toggle-switch {
  position: relative;
  width: 40px;
  height: 22px;
  border-radius: 11px;
  background: var(--gray-700);
  border: 1px solid var(--glass-border);
  cursor: pointer;
  transition: all var(--dur-fast) var(--ease-smooth);
  flex-shrink: 0;
}
.toggle-switch::after {
  content: '';
  position: absolute;
  top: 2px; left: 2px;
  width: 16px; height: 16px;
  border-radius: 50%;
  background: var(--gray-200);
  transition: all var(--dur-fast) var(--ease-spring);
  box-shadow: 0 1px 3px rgba(0,0,0,0.3);
}
.toggle-switch.on {
  background: var(--accent-dim);
  border-color: rgba(91, 245, 196, 0.3);
}
.toggle-switch.on::after {
  left: 20px;
  background: var(--accent);
  box-shadow: 0 0 8px var(--accent-glow);
}

/* Slider */
.setting-range-wrap {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}
.setting-range {
  flex: 1;
  -webkit-appearance: none;
  height: 4px;
  border-radius: 4px;
  background: var(--gray-700);
  outline: none;
}
.setting-range::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 18px; height: 18px;
  border-radius: 50%;
  background: var(--accent);
  border: 0;
  cursor: pointer;
  box-shadow: 0 0 10px var(--accent-glow), 0 2px 6px rgba(0,0,0,0.3);
  transition: transform var(--dur-fast) var(--ease-spring);
}
.setting-range::-webkit-slider-thumb:hover {
  transform: scale(1.15);
}
.range-value {
  min-width: 32px;
  text-align: right;
  font-size: 12px;
  font-family: var(--font-mono);
  color: var(--accent);
}

.settings-footer {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: var(--space-2);
  padding: 0 var(--space-5);
  border-top: 1px solid var(--glass-border);
}

.btn {
  padding: 8px 18px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--glass-border);
  background: rgba(255,255,255,0.05);
  color: var(--gray-200);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all var(--dur-fast) var(--ease-smooth);
}
.btn:hover {
  background: rgba(255,255,255,0.08);
  border-color: var(--glass-border-strong);
}
.btn:active { transform: scale(0.96); }

.btn-accent {
  background: linear-gradient(135deg, rgba(91, 245, 196, 0.2) 0%, rgba(91, 245, 196, 0.1) 100%);
  border-color: rgba(91, 245, 196, 0.25);
  color: var(--accent);
}
.btn-accent:hover {
  background: linear-gradient(135deg, rgba(91, 245, 196, 0.28) 0%, rgba(91, 245, 196, 0.15) 100%);
  border-color: rgba(91, 245, 196, 0.35);
  box-shadow: 0 0 20px rgba(91, 245, 196, 0.1);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST NOTIFICATIONS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.toast-container {
  position: fixed;
  right: var(--space-4);
  bottom: calc(var(--statusbar-height) + var(--space-3));
  display: flex;
  flex-direction: column-reverse;
  gap: var(--space-2);
  z-index: 60;
}

.toast {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  min-width: 240px;
  max-width: 380px;
  padding: var(--space-3) var(--space-4);
  border-radius: var(--radius-md);
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(var(--glass-blur));
  border: 1px solid var(--glass-border-strong);
  box-shadow: 0 8px 32px rgba(0,0,0,0.4);
  color: #fff;
  font-size: 13px;
  transform: translateY(10px) scale(0.96);
  opacity: 0;
  transition: all var(--dur-moderate) var(--ease-out);
}
.toast.open {
  transform: translateY(0) scale(1);
  opacity: 1;
}

.toast-icon {
  width: 24px; height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  flex-shrink: 0;
}
.toast-success .toast-icon {
  background: rgba(91, 245, 196, 0.15);
  color: var(--success);
}
.toast-error .toast-icon {
  background: rgba(255, 107, 138, 0.15);
  color: var(--danger);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DEMO CONTROLS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.demo-controls {
  position: fixed;
  bottom: calc(var(--statusbar-height) + 16px);
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 8px;
  z-index: 100;
  padding: 6px;
  border-radius: var(--radius-lg);
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(var(--glass-blur));
  border: 1px solid var(--glass-border-strong);
  box-shadow: 0 8px 32px rgba(0,0,0,0.4);
}

.demo-btn {
  padding: 6px 14px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--glass-border);
  background: transparent;
  color: var(--gray-200);
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  transition: all var(--dur-fast) var(--ease-smooth);
  white-space: nowrap;
}
.demo-btn:hover {
  background: var(--accent-muted);
  border-color: rgba(91, 245, 196, 0.2);
  color: var(--accent);
}
.demo-btn.active {
  background: var(--accent-muted);
  border-color: rgba(91, 245, 196, 0.3);
  color: var(--accent);
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â• APP SHELL â•â•â•â•â•â•â• -->
<div id="app-shell">

  <!-- â•â•â•â•â•â•â• TOP BAR â•â•â•â•â•â•â• -->
  <div id="topbar">
    <div class="traffic-lights">
      <div class="traffic-light close"></div>
      <div class="traffic-light minimize"></div>
      <div class="traffic-light maximize"></div>
    </div>

    <div id="tab-strip">
      <div class="tab active" data-tab="1">
        <span class="tab-indicator-dot active"></span>
        <span class="tab-title">~/projects/basedshell</span>
        <button class="tab-close">Ã—</button>
      </div>
      <div class="tab" data-tab="2">
        <span class="tab-indicator-dot unread"></span>
        <span class="tab-title">npm run build</span>
        <button class="tab-close">Ã—</button>
      </div>
      <div class="tab" data-tab="3">
        <span class="tab-indicator-dot"></span>
        <span class="tab-title">ssh prod-server</span>
        <button class="tab-close">Ã—</button>
      </div>
      <div class="tab" data-tab="4">
        <span class="tab-indicator-dot exited"></span>
        <span class="tab-title">git log</span>
        <button class="tab-close">Ã—</button>
      </div>
    </div>

    <!-- Search (toggleable) -->
    <div class="search-inline" id="search-inline">
      <input type="text" class="search-input" placeholder="Searchâ€¦" value="createSession">
      <span class="search-counter">3 of 12</span>
      <button class="search-btn">Aa</button>
      <button class="search-btn">.*</button>
      <button class="search-btn" title="Previous">â†‘</button>
      <button class="search-btn" title="Next">â†“</button>
      <button class="search-btn" onclick="toggleSearch()" title="Close">Ã—</button>
    </div>

    <div id="topbar-controls">
      <button class="icon-button" id="search-toggle" onclick="toggleSearch()" title="Search">âŒ•</button>
      <button class="icon-button" onclick="addTab()" title="New tab">+</button>
      <button class="icon-button" onclick="toggleSettings()" title="Settings">âš™</button>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â• TERMINAL HOST â•â•â•â•â•â•â• -->
  <div id="terminal-host">
    <div class="terminal-pane">
      <div class="terminal-content" id="terminal-output">
        <div><span class="prompt">â¯</span> <span class="command">cd ~/projects/basedshell</span></div>
        <div><span class="prompt">â¯</span> <span class="command">git status</span></div>
        <div class="output">On branch main</div>
        <div class="output">Your branch is up to date with 'origin/main'.</div>
        <div class="output">&nbsp;</div>
        <div class="output">Changes not staged for commit:</div>
        <div class="output">&nbsp; <span style="color: var(--danger)">modified:</span>   src/renderer/styles.css</div>
        <div class="output">&nbsp; <span style="color: var(--danger)">modified:</span>   src/renderer/tokens.css</div>
        <div class="output">&nbsp; <span style="color: var(--success)">new file:</span>   src/renderer/glass-theme.ts</div>
        <div class="output">&nbsp;</div>
        <div><span class="prompt">â¯</span> <span class="command">npm run build</span></div>
        <div class="output"><span style="color: var(--accent)">âœ“</span> Compiled renderer in 1.2s</div>
        <div class="output"><span style="color: var(--accent)">âœ“</span> Compiled main process in 0.8s</div>
        <div class="output"><span style="color: var(--accent)">âœ“</span> Build complete â€” dist/</div>
        <div class="output">&nbsp;</div>
        <div><span class="prompt">â¯</span> <span class="cursor-block"></span></div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â• STATUS BAR â•â•â•â•â•â•â• -->
  <div id="statusbar">
    <div class="status-group">
      <div class="status-segment success">
        <span class="status-dot"></span>
        <span>zsh</span>
      </div>
      <div class="status-segment info">
        <span class="status-dot"></span>
        <span>~/projects/basedshell</span>
      </div>
      <div class="status-segment">
        <span class="status-icon">â‡</span>
        <span>main</span>
        <span style="color: var(--warning)">+3</span>
      </div>
    </div>
    <div class="status-group">
      <div class="status-segment success">
        <span>âœ“ 0 Â· 2.0s</span>
      </div>
      <div class="status-segment">
        <span>4 tabs</span>
      </div>
      <div class="status-segment" onclick="toggleSettings()" style="cursor:pointer">
        <span>graphite</span>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â• COMMAND PALETTE â•â•â•â•â•â•â• -->
<div class="palette-scrim" id="palette-scrim" onclick="togglePalette()"></div>
<div class="command-palette" id="command-palette">
  <div class="palette-header">
    <input type="text" class="palette-input" placeholder="Type a commandâ€¦" id="palette-input">
  </div>
  <ul class="palette-results">
    <li class="palette-item active">
      <button class="palette-action">
        <span class="palette-action-icon">+</span>
        <span class="palette-text">
          <span class="palette-title">New Tab</span>
          <span class="palette-meta">Open a new terminal tab</span>
        </span>
        <span class="palette-shortcut"><kbd>âŒ˜</kbd><kbd>T</kbd></span>
      </button>
    </li>
    <li class="palette-item">
      <button class="palette-action">
        <span class="palette-action-icon">âŠ</span>
        <span class="palette-text">
          <span class="palette-title">Split Vertical</span>
          <span class="palette-meta">Split the current pane vertically</span>
        </span>
        <span class="palette-shortcut"><kbd>âŒ˜</kbd><kbd>D</kbd></span>
      </button>
    </li>
    <li class="palette-item">
      <button class="palette-action">
        <span class="palette-action-icon">âŠŸ</span>
        <span class="palette-text">
          <span class="palette-title">Split Horizontal</span>
          <span class="palette-meta">Split the current pane horizontally</span>
        </span>
        <span class="palette-shortcut"><kbd>âŒ˜</kbd><kbd>â‡§</kbd><kbd>D</kbd></span>
      </button>
    </li>
    <li class="palette-item">
      <button class="palette-action">
        <span class="palette-action-icon">âŒ•</span>
        <span class="palette-text">
          <span class="palette-title">Find in Terminal</span>
          <span class="palette-meta">Search terminal output</span>
        </span>
        <span class="palette-shortcut"><kbd>âŒ˜</kbd><kbd>F</kbd></span>
      </button>
    </li>
    <li class="palette-item">
      <button class="palette-action">
        <span class="palette-action-icon">ğŸ¨</span>
        <span class="palette-text">
          <span class="palette-title">Cycle Theme</span>
          <span class="palette-meta">Switch to the next theme</span>
        </span>
        <span class="palette-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
      </button>
    </li>
    <li class="palette-item">
      <button class="palette-action">
        <span class="palette-action-icon">âš™</span>
        <span class="palette-text">
          <span class="palette-title">Open Settings</span>
          <span class="palette-meta">Appearance, terminal, and more</span>
        </span>
        <span class="palette-shortcut"><kbd>âŒ˜</kbd><kbd>,</kbd></span>
      </button>
    </li>
  </ul>
  <div class="palette-footer">
    <span><kbd>â†‘â†“</kbd> navigate</span>
    <span><kbd>â†µ</kbd> select</span>
    <span><kbd>esc</kbd> close</span>
  </div>
</div>

<!-- â•â•â•â•â•â•â• SETTINGS PANEL â•â•â•â•â•â•â• -->
<div class="settings-scrim" id="settings-scrim" onclick="toggleSettings()"></div>
<div class="settings-panel" id="settings-panel">
  <div class="settings-header">
    <h2>Settings</h2>
    <button class="settings-close" onclick="toggleSettings()">Ã—</button>
  </div>
  <div class="settings-body">
    <!-- Appearance -->
    <div class="settings-section">
      <h3>Appearance</h3>
      <div class="setting-row">
        <label>Theme</label>
        <div class="theme-grid">
          <div class="theme-swatch swatch-graphite selected" onclick="selectSwatch(this)">graphite</div>
          <div class="theme-swatch swatch-midnight" onclick="selectSwatch(this)">midnight</div>
          <div class="theme-swatch swatch-aurora" onclick="selectSwatch(this)">aurora</div>
          <div class="theme-swatch swatch-noir" onclick="selectSwatch(this)">noir</div>
          <div class="theme-swatch swatch-fog" onclick="selectSwatch(this)">fog</div>
          <div class="theme-swatch swatch-paper" onclick="selectSwatch(this)">paper</div>
          <div class="theme-swatch swatch-mocha" onclick="selectSwatch(this)">mocha</div>
          <div class="theme-swatch swatch-frappe" onclick="selectSwatch(this)">frappÃ©</div>
          <div class="theme-swatch swatch-macchiato" onclick="selectSwatch(this)">macchiato</div>
        </div>
      </div>
      <div class="setting-row">
        <label>Appearance</label>
        <select class="setting-select">
          <option>System</option>
          <option selected>Dark</option>
          <option>Light</option>
        </select>
      </div>
      <div class="setting-row">
        <label>Opacity</label>
        <div class="setting-range-wrap">
          <input type="range" class="setting-range" min="50" max="100" value="92" oninput="this.nextElementSibling.textContent=this.value+'%'">
          <span class="range-value">92%</span>
        </div>
      </div>
      <div class="toggle-row">
        <span>Vibrancy</span>
        <div class="toggle-switch on" onclick="this.classList.toggle('on')"></div>
      </div>
    </div>

    <!-- Terminal -->
    <div class="settings-section">
      <h3>Terminal</h3>
      <div class="setting-row">
        <label>Font Family</label>
        <input type="text" class="setting-input" value="SF Mono">
      </div>
      <div class="setting-row">
        <label>Font Size</label>
        <div class="setting-range-wrap">
          <input type="range" class="setting-range" min="10" max="24" value="13" oninput="this.nextElementSibling.textContent=this.value+'px'">
          <span class="range-value">13px</span>
        </div>
      </div>
      <div class="setting-row">
        <label>Cursor Style</label>
        <select class="setting-select">
          <option selected>Block</option>
          <option>Bar</option>
          <option>Underline</option>
        </select>
      </div>
      <div class="toggle-row">
        <span>Cursor Blink</span>
        <div class="toggle-switch on" onclick="this.classList.toggle('on')"></div>
      </div>
      <div class="setting-row">
        <label>Scrollback Lines</label>
        <input type="text" class="setting-input" value="10000">
      </div>
      <div class="setting-row">
        <label>Line Height</label>
        <div class="setting-range-wrap">
          <input type="range" class="setting-range" min="100" max="200" value="140" oninput="this.nextElementSibling.textContent=(this.value/100).toFixed(1)">
          <span class="range-value">1.4</span>
        </div>
      </div>
    </div>
  </div>
  <div class="settings-footer">
    <button class="btn" onclick="toggleSettings()">Cancel</button>
    <button class="btn btn-accent" onclick="toggleSettings()">Save</button>
  </div>
</div>

<!-- â•â•â•â•â•â•â• TOAST DEMO â•â•â•â•â•â•â• -->
<div class="toast-container" id="toast-container"></div>

<!-- â•â•â•â•â•â•â• DEMO CONTROLS â•â•â•â•â•â•â• -->
<div class="demo-controls">
  <button class="demo-btn" onclick="togglePalette()">âŒ˜K Palette</button>
  <button class="demo-btn" onclick="toggleSearch()">âŒ˜F Search</button>
  <button class="demo-btn" onclick="toggleSettings()">âŒ˜, Settings</button>
  <button class="demo-btn" onclick="showToast()">Toast</button>
  <button class="demo-btn" onclick="addTab()">+ Tab</button>
</div>

<script>
// â•â•â•â•â•â•â• INTERACTIVE DEMO LOGIC â•â•â•â•â•â•â•

let tabCounter = 4;

function togglePalette() {
  const scrim = document.getElementById('palette-scrim');
  const palette = document.getElementById('command-palette');
  const isOpen = palette.classList.contains('open');
  scrim.classList.toggle('open', !isOpen);
  palette.classList.toggle('open', !isOpen);
  document.getElementById('terminal-host').classList.toggle('dimmed', !isOpen);
  if (!isOpen) {
    setTimeout(() => document.getElementById('palette-input').focus(), 100);
  }
}

function toggleSearch() {
  const search = document.getElementById('search-inline');
  const btn = document.getElementById('search-toggle');
  const isOpen = search.classList.contains('open');
  search.classList.toggle('open', !isOpen);
  btn.classList.toggle('active', !isOpen);
}

function toggleSettings() {
  const scrim = document.getElementById('settings-scrim');
  const panel = document.getElementById('settings-panel');
  const isOpen = panel.classList.contains('open');
  scrim.classList.toggle('open', !isOpen);
  panel.classList.toggle('open', !isOpen);
  document.getElementById('terminal-host').classList.toggle('dimmed', !isOpen);
  // Close palette if open
  if (!isOpen) {
    document.getElementById('palette-scrim').classList.remove('open');
    document.getElementById('command-palette').classList.remove('open');
  }
}

function selectSwatch(el) {
  document.querySelectorAll('.theme-swatch').forEach(s => s.classList.remove('selected'));
  el.classList.add('selected');
}

function addTab() {
  tabCounter++;
  const strip = document.getElementById('tab-strip');
  const names = ['node server.js', 'docker compose', 'vim config.ts', 'tail -f logs', 'htop', 'python3 train.py'];
  const name = names[Math.floor(Math.random() * names.length)];

  // Deactivate existing
  strip.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));

  const tab = document.createElement('div');
  tab.className = 'tab active';
  tab.dataset.tab = tabCounter;
  tab.innerHTML = `
    <span class="tab-indicator-dot active"></span>
    <span class="tab-title">${name}</span>
    <button class="tab-close" onclick="event.stopPropagation(); removeTab(this.parentElement)">Ã—</button>
  `;
  tab.onclick = () => selectTab(tab);

  // Animate in
  tab.style.opacity = '0';
  tab.style.transform = 'translateY(4px)';
  tab.style.maxWidth = '0';
  tab.style.transition = 'all 280ms cubic-bezier(0.16, 1, 0.3, 1)';
  strip.appendChild(tab);
  requestAnimationFrame(() => {
    tab.style.opacity = '1';
    tab.style.transform = 'translateY(0)';
    tab.style.maxWidth = '200px';
  });
}

function removeTab(tab) {
  tab.style.opacity = '0';
  tab.style.maxWidth = '0';
  tab.style.padding = '0';
  tab.style.margin = '0';
  tab.style.transition = 'all 240ms cubic-bezier(0.55, 0, 1, 0.45)';
  setTimeout(() => {
    tab.remove();
    // Activate last tab if we removed the active one
    const tabs = document.querySelectorAll('.tab');
    if (tabs.length && !document.querySelector('.tab.active')) {
      tabs[tabs.length - 1].classList.add('active');
    }
  }, 240);
}

function selectTab(tab) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  tab.classList.add('active');
}

// Add click handlers to existing tabs
document.querySelectorAll('.tab').forEach(tab => {
  tab.onclick = () => selectTab(tab);
  tab.querySelector('.tab-close').onclick = (e) => {
    e.stopPropagation();
    removeTab(tab);
  };
});

let toastCount = 0;
function showToast() {
  const container = document.getElementById('toast-container');
  const messages = [
    { type: 'success', icon: 'âœ“', text: 'Settings saved successfully' },
    { type: 'success', icon: 'âœ“', text: 'Theme applied: graphite' },
    { type: 'error', icon: '!', text: 'Session disconnected' },
    { type: 'success', icon: 'â‡', text: 'Switched to branch: feature/glass-ui' },
  ];
  const msg = messages[toastCount % messages.length];
  toastCount++;

  const toast = document.createElement('div');
  toast.className = `toast toast-${msg.type}`;
  toast.innerHTML = `
    <span class="toast-icon">${msg.icon}</span>
    <span>${msg.text}</span>
  `;
  container.appendChild(toast);
  requestAnimationFrame(() => toast.classList.add('open'));

  setTimeout(() => {
    toast.classList.remove('open');
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}

// Keyboard shortcuts
document.addEventListener('keydown', (e) => {
  if (e.metaKey && e.key === 'k') { e.preventDefault(); togglePalette(); }
  if (e.metaKey && e.key === 'f') { e.preventDefault(); toggleSearch(); }
  if (e.metaKey && e.key === ',') { e.preventDefault(); toggleSettings(); }
  if (e.metaKey && e.key === 't') { e.preventDefault(); addTab(); }
  if (e.key === 'Escape') {
    document.getElementById('palette-scrim').classList.remove('open');
    document.getElementById('command-palette').classList.remove('open');
    document.getElementById('settings-scrim').classList.remove('open');
    document.getElementById('settings-panel').classList.remove('open');
    document.getElementById('terminal-host').classList.remove('dimmed');
  }
});
</script>
</body>
</html>
